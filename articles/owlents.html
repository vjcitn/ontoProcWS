<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ontology concepts and tools in Bioconductor for Bioc2024 • ontoProcWS</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Ontology concepts and tools in Bioconductor for Bioc2024">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">


    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">ontoProcWS</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.4</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    Articles

    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/owlents.html">Ontology concepts and tools in Bioconductor for Bioc2024</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/vjcitn/ontoProcWS/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Ontology concepts and tools in Bioconductor for
Bioc2024</h1>
                        <h4 data-toc-skip class="author">Vincent J.
Carey, stvjc at channing.harvard.edu</h4>
            
            <h4 data-toc-skip class="date">July 21, 2024</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/vjcitn/ontoProcWS/blob/main/vignettes/owlents.Rmd" class="external-link"><code>vignettes/owlents.Rmd</code></a></small>
      <div class="hidden name"><code>owlents.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="objectives">Objectives<a class="anchor" aria-label="anchor" href="#objectives"></a>
</h2>
<ul>
<li><p>introduction to ontology-related computations in R with the ORDO
rare disease ontology and CL cell ontology</p></li>
<li><p>review of general ontology resources and the OWL RDF/XML
serialization</p></li>
<li><p>retrieving, updating, searching for OWL representations of
ontologies using <code>BiocFileCache</code> and
<code>owl2cache</code></p></li>
<li><p>Ontology mapping of phenotypes of the GWAS catalog using
Experimental Feature Ontology</p></li>
</ul>
</div>
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<div class="section level3">
<h3 id="ordo-for-rare-diseases">ORDO for rare diseases<a class="anchor" aria-label="anchor" href="#ordo-for-rare-diseases"></a>
</h3>
<p>Our first example uses the ORDO ontology, which is distributed in
compressed OWL format with the ontoProc package.</p>
<p>Here are the first 18 lines of the OWL XML:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vjcitn/ontoProc" class="external-link">ontoProc</a></span><span class="op">)</span></span>
<span><span class="va">pa</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ontoProc/man/get_ordo_owl_path.html" class="external-link">get_ordo_owl_path</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/readLines.html" class="external-link">readLines</a></span><span class="op">(</span><span class="va">pa</span>, <span class="fl">18</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "&lt;?xml version=\"1.0\"?&gt;"                                                                                           </span></span>
<span><span class="co">##  [2] "&lt;rdf:RDF xmlns=\"http://www.w3.org/2002/07/owl#\""                                                                 </span></span>
<span><span class="co">##  [3] "     xml:base=\"http://www.w3.org/2002/07/owl\""                                                                   </span></span>
<span><span class="co">##  [4] "     xmlns:dc=\"http://purl.org/dc/elements/1.1/\""                                                                </span></span>
<span><span class="co">##  [5] "     xmlns:efo=\"http://www.ebi.ac.uk/efo/\""                                                                      </span></span>
<span><span class="co">##  [6] "     xmlns:obo=\"http://purl.obolibrary.org/obo/\""                                                                </span></span>
<span><span class="co">##  [7] "     xmlns:owl=\"http://www.w3.org/2002/07/owl#\""                                                                 </span></span>
<span><span class="co">##  [8] "     xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\""                                                    </span></span>
<span><span class="co">##  [9] "     xmlns:xml=\"http://www.w3.org/XML/1998/namespace\""                                                           </span></span>
<span><span class="co">## [10] "     xmlns:xsd=\"http://www.w3.org/2001/XMLSchema#\""                                                              </span></span>
<span><span class="co">## [11] "     xmlns:ORDO=\"http://www.orpha.net/ORDO/\""                                                                    </span></span>
<span><span class="co">## [12] "     xmlns:rdfs=\"http://www.w3.org/2000/01/rdf-schema#\""                                                         </span></span>
<span><span class="co">## [13] "     xmlns:skos=\"http://www.w3.org/2004/02/skos/core#\""                                                          </span></span>
<span><span class="co">## [14] "     xmlns:terms=\"http://purl.org/dc/terms/\""                                                                    </span></span>
<span><span class="co">## [15] "     xmlns:licenses=\"https://creativecommons.org/licenses/\""                                                     </span></span>
<span><span class="co">## [16] "     xmlns:oboInOwl=\"http://www.geneontology.org/formats/oboInOwl#\"&gt;"                                            </span></span>
<span><span class="co">## [17] "    &lt;Ontology rdf:about=\"https://www.orphadata.com/data/ontologies/ordo/last_version/ORDO_en_4.2.owl\"&gt;"          </span></span>
<span><span class="co">## [18] "        &lt;versionIRI rdf:resource=\"https://www.orphadata.com/data/ontologies/ordo/last_version/ORDO_en_4.2.owl\"/&gt;"</span></span></code></pre>
<p>This establishes a variety of namespaces and other metadata for
annotations that will be used throughout the ontology. Of particular
interest is the version string towards the end. As of 3 July 2024,
version 4.5 has been published. We are working with version 4.2.</p>
<p>ontoProc uses an interface (via the reticulate package) to the <a href="https://owlready2.readthedocs.io/en/v0.42/" class="external-link">owlready2</a> python
modules distributed via pypi.</p>
<p>Ingestion is typically fast and returns an instance of the S3 class
<code>owlents</code>.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">orde</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ontoProc/man/setup_entities.html" class="external-link">setup_entities</a></span><span class="op">(</span><span class="va">pa</span><span class="op">)</span></span>
<span><span class="va">orde</span></span></code></pre></div>
<pre><code><span><span class="co">## owlents instance with 15239 classes.</span></span></code></pre>
<p>The most common conceptual relationship encoded in the ontologies to
be considered is “is-a”. Given any term in the ontology, its ancestors
are terms that are successively more general.</p>
<p>Let’s look at two terms. Given an owlents instance <code>x</code> and
a numeric vector <code>n</code>, <code>x[n]</code> ‘subsets’ the
information to the selected terms.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">orde</span><span class="op">[</span><span class="fl">1000</span><span class="op">:</span><span class="fl">1001</span><span class="op">]</span></span></code></pre></div>
<pre><code><span><span class="co">## owlents instance with 2 classes.</span></span></code></pre>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/pkg/ontoProc/man/ancestors.html" class="external-link">ancestors</a></span><span class="op">(</span><span class="va">orde</span><span class="op">[</span><span class="fl">1000</span><span class="op">:</span><span class="fl">1001</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## $Orphanet_79083</span></span>
<span><span class="co">## {owl.Thing, ORDO.Orphanet_557493, ORDO.Orphanet_79083, ORDO.Orphanet_377788, ORDO.Orphanet_C001}</span></span>
<span><span class="co">## </span></span>
<span><span class="co">## $Orphanet_146</span></span>
<span><span class="co">## {owl.Thing, ORDO.Orphanet_146, ORDO.Orphanet_557493, ORDO.Orphanet_377788, ORDO.Orphanet_C001}</span></span></code></pre>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/labels.html" class="external-link">labels</a></span><span class="op">(</span><span class="va">orde</span><span class="op">[</span><span class="fl">1000</span><span class="op">:</span><span class="fl">1001</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##                                 Orphanet_79083 </span></span>
<span><span class="co">## "PPARG-related familial partial lipodystrophy" </span></span>
<span><span class="co">##                                   Orphanet_146 </span></span>
<span><span class="co">##             "Differentiated thyroid carcinoma"</span></span></code></pre>
<p>Here we are seeing a mix of R and python references. As this package
matures, this mixing should diminish.</p>
<p>We can use character tags to subset owlents instances as well. This
is how we “decode” two of the ancestors of <code>orde[1000]</code>.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/labels.html" class="external-link">labels</a></span><span class="op">(</span><span class="va">orde</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Orphanet_377788"</span>, <span class="st">"Orphanet_557493"</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Orphanet_377788 Orphanet_557493 </span></span>
<span><span class="co">##       "Disease"      "disorder"</span></span></code></pre>
<p>A new feature of ontoProc’s OWL processing is the availability of
searching labels with regular expression matching. This feature is built
in to owlready2.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">lsrch</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ontoProc/man/search_labels.html" class="external-link">search_labels</a></span><span class="op">(</span><span class="va">orde</span>, <span class="st">"*lipodystrophy*"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">lsrch</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## [1] 26</span></span></code></pre>
<p>To visualize relationships among the terms, a plot method leverages
the ontologyIndex packages from CRAN.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">orde</span>, <span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">lsrch</span><span class="op">)</span><span class="op">[</span><span class="fl">15</span><span class="op">:</span><span class="fl">25</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="owlents_files/figure-html/lkpl-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="cell-ontology">Cell ontology<a class="anchor" aria-label="anchor" href="#cell-ontology"></a>
</h3>
<p>The <code>owl2cache</code> function retrieves OWL from a URL or file
and places it in a cache to avoid repetitious retrievals. The default
cache is the one defined by <code><a href="https://rdrr.io/pkg/BiocFileCache/man/BiocFileCache-class.html" class="external-link">BiocFileCache::BiocFileCache()</a></code>.
Here we work with the cell ontology. <code>setup_entities</code> will
use owlready2 python modules to parse the OWL and produce an instance of
S3 class <code>owlents</code>.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/vjcitn/ontoProc" class="external-link">ontoProc</a></span><span class="op">)</span></span>
<span><span class="va">clont_path</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ontoProc/man/owl2cache.html" class="external-link">owl2cache</a></span><span class="op">(</span>url<span class="op">=</span><span class="st">"http://purl.obolibrary.org/obo/cl.owl"</span><span class="op">)</span></span>
<span><span class="va">cle</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ontoProc/man/setup_entities.html" class="external-link">setup_entities</a></span><span class="op">(</span><span class="va">clont_path</span><span class="op">)</span></span>
<span><span class="va">cle</span></span></code></pre></div>
<pre><code><span><span class="co">## owlents instance with 16180 classes.</span></span></code></pre>
<p>A plot method is available. Given a vector of tags as reported in OWL
(no colons are used), the plot method produces an ontologyIndex instance
and runs onto_plot2 on the result.</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sel</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"CL_0000492"</span>, <span class="st">"CL_0001054"</span>, <span class="st">"CL_0000236"</span>, </span>
<span><span class="st">"CL_0000625"</span>, <span class="st">"CL_0000576"</span>, </span>
<span><span class="st">"CL_0000623"</span>, <span class="st">"CL_0000451"</span>, <span class="st">"CL_0000556"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cle</span>, <span class="va">sel</span><span class="op">)</span></span></code></pre></div>
<p><img src="owlents_files/figure-html/lkcl-1.png" width="700"></p>
</div>
<div class="section level3">
<h3 id="illustrations-with-human-phenotype-ontology">Illustrations with Human Phenotype ontology<a class="anchor" aria-label="anchor" href="#illustrations-with-human-phenotype-ontology"></a>
</h3>
<p>We’ll obtain and ad hoc selection of 15 UBERON term names and
visualize the hierarchy.</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hpont_path</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ontoProc/man/owl2cache.html" class="external-link">owl2cache</a></span><span class="op">(</span>url<span class="op">=</span><span class="st">"http://purl.obolibrary.org/obo/hp.owl"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## resource BFC2 already in cache from http://purl.obolibrary.org/obo/hp.owl</span></span></code></pre>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hpents</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/ontoProc/man/setup_entities.html" class="external-link">setup_entities</a></span><span class="op">(</span><span class="va">hpont_path</span><span class="op">)</span></span>
<span><span class="va">kp</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">"UBER"</span>, <span class="va">hpents</span><span class="op">$</span><span class="va">clnames</span>, value<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span><span class="op">[</span><span class="fl">21</span><span class="op">:</span><span class="fl">35</span><span class="op">]</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">hpents</span>, <span class="va">kp</span><span class="op">)</span></span></code></pre></div>
<p><img src="owlents_files/figure-html/gethp-1.png" width="700"></p>
<p>The prefixes of class names in the ontology give a sense of its
scope.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/table.html" class="external-link">table</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/strsplit.html" class="external-link">strsplit</a></span><span class="op">(</span><span class="va">hpents</span><span class="op">$</span><span class="va">clnames</span>, <span class="st">"_"</span><span class="op">)</span>, <span class="st">"["</span>, <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##         </span></span>
<span><span class="co">##          [,1] </span></span>
<span><span class="co">##   BFO       11</span></span>
<span><span class="co">##   CHEBI   1848</span></span>
<span><span class="co">##   CL      1144</span></span>
<span><span class="co">##   GO      2565</span></span>
<span><span class="co">##   HP     19161</span></span>
<span><span class="co">##   HsapDv    12</span></span>
<span><span class="co">##   MPATH     75</span></span>
<span><span class="co">##   NBO      143</span></span>
<span><span class="co">##   PATO     572</span></span>
<span><span class="co">##   PR       206</span></span>
<span><span class="co">##   RO         1</span></span>
<span><span class="co">##   UBERON  5604</span></span></code></pre>
<p>To characterize human phenotypes ontologically, CL, GO, CHEBI, and
UBERON play significant roles.</p>
</div>
</div>
<div class="section level2">
<h2 id="caching">Caching<a class="anchor" aria-label="anchor" href="#caching"></a>
</h2>
<p>We described <code>owl2cache</code> above. By default,
BiocFileCache’s cache is used. Query it for all available OWL files.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">BiocFileCache</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: dbplyr</span></span></code></pre>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ca</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/BiocFileCache/man/BiocFileCache-class.html" class="external-link">BiocFileCache</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/BiocFileCache/man/BiocFileCache-class.html" class="external-link">bfcquery</a></span><span class="op">(</span><span class="va">ca</span>, <span class="st">"owl"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># A tibble: 2 × 10</span></span></span>
<span><span class="co">##   rid   rname create_time access_time rpath rtype fpath last_modified_time etag </span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>              <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> BFC1  cl.o… 2024-07-21… 2024-07-21… /git… web   http… 2024-07-10 14:23:… 0x8D…</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> BFC2  hp.o… 2024-07-21… 2024-07-21… /git… web   http… 2024-07-01 14:29:… 0x8D…</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ 1 more variable: expires &lt;dbl&gt;</span></span></span></code></pre>
<p>At present there is no attempt to identify ontology version. This
enhancement may be introduced in a future revision of ontoProc.</p>
<p>Once we have the path, <code>setup_entities</code> will deserialize
the content to the <code>owlents</code> class.</p>
</div>
<div class="section level2">
<h2 id="ontology-of-gwas-outcomes-in-the-gwas-catalog">Ontology of GWAS outcomes in the GWAS catalog<a class="anchor" aria-label="anchor" href="#ontology-of-gwas-outcomes-in-the-gwas-catalog"></a>
</h2>
<p>In this section we examine a package that is under development, <a href="https://github.com/ccb-hms/gwasCatSearch" class="external-link">gwasCatSearch</a>. This
uses ideas from the <a href="https://github.com/INCATools/semantic-sql" class="external-link">semantic sql
project</a> to improve performance of the most common operations on
ontologies.</p>
<p>We’ll use the search app at <a href="https://vjcitn.shinyapps.io/gwasCatSearch" class="external-link">shinyapps.io</a> to
explore connections between the GWAS catalog and the Experimental Factor
Ontology used to annotate GWAS outcomes. Intermediate components are
corpustools for enhancing discovery in natural language formulations of
phenotypes, and SQLite, with tables representing ontology terms and
their ancestors and descendants.</p>
<p>This segment gives some sense of how outcomes can be sorted according
to the frequency of recorded hits in the catalog, and the associated EFO
terms decoded.</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va">gwasCatSearch</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## Loading required package: corpustools</span></span></code></pre>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://rsqlite.r-dbi.org" class="external-link">RSQLite</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## </span></span>
<span><span class="co">## Attaching package: 'dplyr'</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:dbplyr':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     ident, sql</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:stats':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     filter, lag</span></span></code></pre>
<pre><code><span><span class="co">## The following objects are masked from 'package:base':</span></span>
<span><span class="co">## </span></span>
<span><span class="co">##     intersect, setdiff, setequal, union</span></span></code></pre>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">con</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/pkg/gwasCatSearch/man/gwasCatSearch_dbconn.html" class="external-link">gwasCatSearch_dbconn</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="fu">dbListTables</span><span class="op">(</span><span class="va">con</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">##  [1] "efo_dbxrefs"              "efo_edges"               </span></span>
<span><span class="co">##  [3] "efo_entailed_edges"       "efo_labels"              </span></span>
<span><span class="co">##  [5] "efo_synonyms"             "gwascatalog_associations"</span></span>
<span><span class="co">##  [7] "gwascatalog_mappings"     "gwascatalog_metadata"    </span></span>
<span><span class="co">##  [9] "gwascatalog_references"   "uberon_edges"            </span></span>
<span><span class="co">## [11] "uberon_entailed_edges"    "uberon_labels"           </span></span>
<span><span class="co">## [13] "uberon_synonyms"          "version_info"</span></span></code></pre>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html" class="external-link">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"gwascatalog_associations"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html" class="external-link">select</a></span><span class="op">(</span><span class="va">MAPPED_TRAIT_URI</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>    <span class="fu"><a href="https://dplyr.tidyverse.org/reference/group_by.html" class="external-link">group_by</a></span><span class="op">(</span><span class="va">MAPPED_TRAIT_URI</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/summarise.html" class="external-link">summarise</a></span><span class="op">(</span>n<span class="op">=</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/context.html" class="external-link">n</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html" class="external-link">arrange</a></span><span class="op">(</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/desc.html" class="external-link">desc</a></span><span class="op">(</span><span class="va">n</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># Source:     SQL [?? x 2]</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Database:   sqlite 3.46.0 [/tmp/RtmpkN0oQQ/gwascatalog_search.db]</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Ordered by: desc(n)</span></span></span>
<span><span class="co">##    MAPPED_TRAIT_URI                         n</span></span>
<span><span class="co">##    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                                <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 1</span> http://www.ebi.ac.uk/efo/EFO_0004339 <span style="text-decoration: underline;">25</span>475</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 2</span> http://www.ebi.ac.uk/efo/EFO_0004340 <span style="text-decoration: underline;">13</span>668</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 3</span> http://www.ebi.ac.uk/efo/EFO_0004612  <span style="text-decoration: underline;">8</span>100</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 4</span> http://www.ebi.ac.uk/efo/EFO_0007937  <span style="text-decoration: underline;">8</span>045</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 5</span> http://www.ebi.ac.uk/efo/EFO_0007788  <span style="text-decoration: underline;">7</span>796</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 6</span> http://www.ebi.ac.uk/efo/EFO_0004530  <span style="text-decoration: underline;">7</span>749</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 7</span> http://www.ebi.ac.uk/efo/EFO_0005664  <span style="text-decoration: underline;">6</span>815</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 8</span> http://www.ebi.ac.uk/efo/EFO_0004747  <span style="text-decoration: underline;">6</span>758</span></span>
<span><span class="co">## <span style="color: #BCBCBC;"> 9</span> http://www.ebi.ac.uk/efo/EFO_0004611  <span style="text-decoration: underline;">6</span>568</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">10</span> http://www.ebi.ac.uk/efo/EFO_0007874  <span style="text-decoration: underline;">6</span>547</span></span>
<span><span class="co">## <span style="color: #949494;"># ℹ more rows</span></span></span></code></pre>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/tbl.html" class="external-link">tbl</a></span><span class="op">(</span><span class="va">con</span>, <span class="st">"efo_labels"</span><span class="op">)</span> <span class="op">|&gt;</span> <span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html" class="external-link">filter</a></span><span class="op">(</span><span class="va">Subject</span> <span class="op"><a href="https://rdrr.io/r/base/match.html" class="external-link">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"EFO:0004340"</span>, <span class="st">"EFO:0004612"</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">## <span style="color: #949494;"># Source:   SQL [2 x 6]</span></span></span>
<span><span class="co">## <span style="color: #949494;"># Database: sqlite 3.46.0 [/tmp/RtmpkN0oQQ/gwascatalog_search.db]</span></span></span>
<span><span class="co">##   Subject     Object                      IRI   DiseaseLocation Direct Inherited</span></span>
<span><span class="co">##   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>                       <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>            <span style="color: #949494; font-style: italic;">&lt;int&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">## <span style="color: #BCBCBC;">1</span> EFO:0004340 body mass index             http… <span style="color: #BB0000;">NA</span>                 307        31</span></span>
<span><span class="co">## <span style="color: #BCBCBC;">2</span> EFO:0004612 high density lipoprotein c… http… <span style="color: #BB0000;">NA</span>                 489        17</span></span></code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

      </div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Vincent Carey.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

      </footer>
</div>






  </body>
</html>
